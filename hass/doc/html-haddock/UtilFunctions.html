<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN" "http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd"><html xmlns="http://www.w3.org/1999/xhtml"><head><meta http-equiv="Content-Type" content="text/html; charset=UTF-8" /><title>UtilFunctions</title><link href="ocean.css" rel="stylesheet" type="text/css" title="Ocean" /><script src="haddock-util.js" type="text/javascript"></script><script type="text/javascript">//<![CDATA[
window.onload = function () {pageLoad();setSynopsis("mini_UtilFunctions.html");};
//]]>
</script></head><body><div id="package-header"><ul class="links" id="page-menu"><li><a href="src/UtilFunctions.html">Source</a></li><li><a href="index.html">Contents</a></li><li><a href="doc-index.html">Index</a></li></ul><p class="caption">hass-0.9.9.0</p></div><div id="content"><div id="module-header"><table class="info"><tr><th>Stability</th><td>experimental</td></tr><tr><th>Portability</th><td>POSIX</td></tr><tr><th>Safe Haskell</th><td>None</td></tr><tr><th>Language</th><td>Haskell2010</td></tr></table><p class="caption">UtilFunctions</p></div><div id="table-of-contents"><p class="caption">Contents</p><ul><li><a href="#g:1">Actions with temporary effects
</a></li><li><a href="#g:2">If-functions
</a></li></ul></div><div id="description"><p class="caption">Description</p><div class="doc"><p>Utility functions to be used in other <strong>hass</strong> modules.</p></div></div><div id="synopsis"><p id="control.syn" class="caption expander" onclick="toggleSection('syn')">Synopsis</p><ul id="section.syn" class="hide" onclick="toggleSection('syn')"><li class="src short"><a href="#v:die">die</a> :: <a href="../base-4.8.1.0/Data-String.html#t:String">String</a> -&gt; <a href="../base-4.8.1.0/System-IO.html#t:IO">IO</a> ()</li><li class="src short"><a href="#v:getByteLine">getByteLine</a> :: <a href="../base-4.8.1.0/System-IO.html#t:IO">IO</a> <a href="../bytestring-0.10.6.0/Data-ByteString-Lazy.html#t:ByteString">ByteString</a></li><li class="src short"><a href="#v:toClipboard">toClipboard</a> :: <a href="../bytestring-0.10.6.0/Data-ByteString-Lazy.html#t:ByteString">ByteString</a> -&gt; <a href="../base-4.8.1.0/System-IO.html#t:IO">IO</a> ()</li><li class="src short"><a href="#v:hassDir">hassDir</a> :: <a href="../base-4.8.1.0/System-IO.html#t:IO">IO</a> <a href="../MissingH-1.3.0.1/System-IO-HVFS.html#t:FilePath">FilePath</a></li><li class="src short"><a href="#v:passPath">passPath</a> :: <a href="../base-4.8.1.0/Data-String.html#t:String">String</a> -&gt; <a href="../base-4.8.1.0/System-IO.html#t:IO">IO</a> <a href="../MissingH-1.3.0.1/System-IO-HVFS.html#t:FilePath">FilePath</a></li><li class="src short"><a href="#v:makeRelativeToHass">makeRelativeToHass</a> :: <a href="../MissingH-1.3.0.1/System-IO-HVFS.html#t:FilePath">FilePath</a> -&gt; <a href="../base-4.8.1.0/System-IO.html#t:IO">IO</a> <a href="../MissingH-1.3.0.1/System-IO-HVFS.html#t:FilePath">FilePath</a></li><li class="src short"><a href="#v:checkSneakyPaths">checkSneakyPaths</a> :: <a href="../MissingH-1.3.0.1/System-IO-HVFS.html#t:FilePath">FilePath</a> -&gt; <a href="../base-4.8.1.0/Data-Bool.html#t:Bool">Bool</a></li><li class="src short"><a href="#v:listDirectory">listDirectory</a> :: <a href="../MissingH-1.3.0.1/System-IO-HVFS.html#t:FilePath">FilePath</a> -&gt; <a href="../base-4.8.1.0/System-IO.html#t:IO">IO</a> [<a href="../MissingH-1.3.0.1/System-IO-HVFS.html#t:FilePath">FilePath</a>]</li><li class="src short"><a href="#v:listRemovingDirectory">listRemovingDirectory</a> :: <a href="../MissingH-1.3.0.1/System-IO-HVFS.html#t:FilePath">FilePath</a> -&gt; <a href="../base-4.8.1.0/System-IO.html#t:IO">IO</a> [<a href="../MissingH-1.3.0.1/System-IO-HVFS.html#t:FilePath">FilePath</a>]</li><li class="src short"><a href="#v:createStorageDir">createStorageDir</a> :: <a href="../base-4.8.1.0/Data-String.html#t:String">String</a> -&gt; <a href="../base-4.8.1.0/System-IO.html#t:IO">IO</a> ()</li><li class="src short"><a href="#v:createPath">createPath</a> :: <a href="../MissingH-1.3.0.1/System-IO-HVFS.html#t:FilePath">FilePath</a> -&gt; <a href="../base-4.8.1.0/System-IO.html#t:IO">IO</a> ()</li><li class="src short"><a href="#v:traverseStore">traverseStore</a> :: <a href="Types.html#t:TraverseReqs">TraverseReqs</a> -&gt; <a href="../MissingH-1.3.0.1/System-IO-HVFS.html#t:FilePath">FilePath</a> -&gt; <a href="../base-4.8.1.0/System-IO.html#t:IO">IO</a> ()</li><li class="src short"><a href="#v:prompt">prompt</a> :: <a href="../MissingH-1.3.0.1/System-IO-HVFS.html#t:FilePath">FilePath</a> -&gt; <a href="../base-4.8.1.0/System-IO.html#t:IO">IO</a> <a href="../base-4.8.1.0/Data-Bool.html#t:Bool">Bool</a></li><li class="src short"><a href="#v:parseConfirmationRequest">parseConfirmationRequest</a> :: <a href="../base-4.8.1.0/Data-Bool.html#t:Bool">Bool</a> -&gt; <a href="../base-4.8.1.0/Data-String.html#t:String">String</a> -&gt; <a href="../base-4.8.1.0/Data-Bool.html#t:Bool">Bool</a></li><li class="src short"><a href="#v:withEcho">withEcho</a> :: <a href="../base-4.8.1.0/Data-Bool.html#t:Bool">Bool</a> -&gt; <a href="../base-4.8.1.0/System-IO.html#t:IO">IO</a> a -&gt; <a href="../base-4.8.1.0/System-IO.html#t:IO">IO</a> a</li><li class="src short"><a href="#v:withTempFile">withTempFile</a> :: (<a href="../MissingH-1.3.0.1/System-IO-HVFS.html#t:FilePath">FilePath</a> -&gt; <a href="../base-4.8.1.0/GHC-IO-Handle.html#t:Handle">Handle</a> -&gt; <a href="../base-4.8.1.0/System-IO.html#t:IO">IO</a> a) -&gt; <a href="../base-4.8.1.0/System-IO.html#t:IO">IO</a> a</li><li class="src short"><a href="#v:withDirectory">withDirectory</a> :: <a href="../MissingH-1.3.0.1/System-IO-HVFS.html#t:FilePath">FilePath</a> -&gt; <a href="../base-4.8.1.0/System-IO.html#t:IO">IO</a> a -&gt; <a href="../base-4.8.1.0/System-IO.html#t:IO">IO</a> a</li><li class="src short"><a href="#v:-63-">(?)</a> :: <a href="../base-4.8.1.0/Data-Bool.html#t:Bool">Bool</a> -&gt; a -&gt; a -&gt; a</li><li class="src short"><a href="#v:ifOn">ifOn</a> :: a -&gt; a -&gt; <a href="../base-4.8.1.0/Data-Bool.html#t:Bool">Bool</a> -&gt; a</li><li class="src short"><a href="#v:ifM">ifM</a> :: <a href="../base-4.8.1.0/Control-Monad.html#t:Monad">Monad</a> m =&gt; m <a href="../base-4.8.1.0/Data-Bool.html#t:Bool">Bool</a> -&gt; m a -&gt; m a -&gt; m a</li><li class="src short"><a href="#v:whenM">whenM</a> :: <a href="../base-4.8.1.0/Control-Monad.html#t:Monad">Monad</a> m =&gt; m <a href="../base-4.8.1.0/Data-Bool.html#t:Bool">Bool</a> -&gt; m () -&gt; m ()</li><li class="src short"><a href="#v:-63-..">(?..)</a> :: <a href="../base-4.8.1.0/Data-Maybe.html#t:Maybe">Maybe</a> a -&gt; b -&gt; (a -&gt; b) -&gt; b</li></ul></div><div id="interface"><h1>Documentation</h1><div class="top"><p class="src"><a name="v:die" class="def">die</a> :: <a href="../base-4.8.1.0/Data-String.html#t:String">String</a> -&gt; <a href="../base-4.8.1.0/System-IO.html#t:IO">IO</a> () <a href="src/UtilFunctions.html#die" class="link">Source</a></p><div class="doc"><p>Output an error message to <em>stderr</em> stream and exit with exit code 1.
 Should be used only at user-interaction level (such as prompting for master password),
 not instead of exceptions.</p></div></div><div class="top"><p class="src"><a name="v:getByteLine" class="def">getByteLine</a> :: <a href="../base-4.8.1.0/System-IO.html#t:IO">IO</a> <a href="../bytestring-0.10.6.0/Data-ByteString-Lazy.html#t:ByteString">ByteString</a> <a href="src/UtilFunctions.html#getByteLine" class="link">Source</a></p><div class="doc"><p>The equivalent of <code><a href="../base-4.8.1.0/System-IO.html#v:getLine">getLine</a></code> for <code><a href="../bytestring-0.10.6.0/Data-ByteString-Lazy.html#t:ByteString">ByteString</a></code>s.</p></div></div><div class="top"><p class="src"><a name="v:toClipboard" class="def">toClipboard</a> :: <a href="../bytestring-0.10.6.0/Data-ByteString-Lazy.html#t:ByteString">ByteString</a> -&gt; <a href="../base-4.8.1.0/System-IO.html#t:IO">IO</a> () <a href="src/UtilFunctions.html#toClipboard" class="link">Source</a></p><div class="doc"><p>Sets clipboard, starting a daemon to wait 45 seconds and then erase the clipboard.</p></div></div><div class="top"><p class="src"><a name="v:hassDir" class="def">hassDir</a> :: <a href="../base-4.8.1.0/System-IO.html#t:IO">IO</a> <a href="../MissingH-1.3.0.1/System-IO-HVFS.html#t:FilePath">FilePath</a> <a href="src/UtilFunctions.html#hassDir" class="link">Source</a></p><div class="doc"><p>The <strong>hass</strong> directory containing password storages.</p></div></div><div class="top"><p class="src"><a name="v:passPath" class="def">passPath</a> :: <a href="../base-4.8.1.0/Data-String.html#t:String">String</a> -&gt; <a href="../base-4.8.1.0/System-IO.html#t:IO">IO</a> <a href="../MissingH-1.3.0.1/System-IO-HVFS.html#t:FilePath">FilePath</a> <a href="src/UtilFunctions.html#passPath" class="link">Source</a></p><div class="doc"><p>Exports path to concrete password file or directory.</p></div></div><div class="top"><p class="src"><a name="v:makeRelativeToHass" class="def">makeRelativeToHass</a> :: <a href="../MissingH-1.3.0.1/System-IO-HVFS.html#t:FilePath">FilePath</a> -&gt; <a href="../base-4.8.1.0/System-IO.html#t:IO">IO</a> <a href="../MissingH-1.3.0.1/System-IO-HVFS.html#t:FilePath">FilePath</a> <a href="src/UtilFunctions.html#makeRelativeToHass" class="link">Source</a></p><div class="doc"><p>Extract only the part of the path relative to <strong>hass</strong> password storage directory.
 Does not resolve special entries like <code>..</code>.</p></div></div><div class="top"><p class="src"><a name="v:checkSneakyPaths" class="def">checkSneakyPaths</a> :: <a href="../MissingH-1.3.0.1/System-IO-HVFS.html#t:FilePath">FilePath</a> -&gt; <a href="../base-4.8.1.0/Data-Bool.html#t:Bool">Bool</a> <a href="src/UtilFunctions.html#checkSneakyPaths" class="link">Source</a></p><div class="doc"><p>Checks if a sneaky path was entered, such as containing <code>..</code>.</p></div></div><div class="top"><p class="src"><a name="v:listDirectory" class="def">listDirectory</a> :: <a href="../MissingH-1.3.0.1/System-IO-HVFS.html#t:FilePath">FilePath</a> -&gt; <a href="../base-4.8.1.0/System-IO.html#t:IO">IO</a> [<a href="../MissingH-1.3.0.1/System-IO-HVFS.html#t:FilePath">FilePath</a>] <a href="src/UtilFunctions.html#listDirectory" class="link">Source</a></p><div class="doc"><p>List directory entries, skipping dot files. To be used in listing action.</p></div></div><div class="top"><p class="src"><a name="v:listRemovingDirectory" class="def">listRemovingDirectory</a> :: <a href="../MissingH-1.3.0.1/System-IO-HVFS.html#t:FilePath">FilePath</a> -&gt; <a href="../base-4.8.1.0/System-IO.html#t:IO">IO</a> [<a href="../MissingH-1.3.0.1/System-IO-HVFS.html#t:FilePath">FilePath</a>] <a href="src/UtilFunctions.html#listRemovingDirectory" class="link">Source</a></p><div class="doc"><p>List all directory entries except <code>.</code>, <code>..</code> and <code>.check</code>.
 To be used during removal to correctly check if the directory is empty of needed files.</p></div></div><div class="top"><p class="src"><a name="v:createStorageDir" class="def">createStorageDir</a> :: <a href="../base-4.8.1.0/Data-String.html#t:String">String</a> -&gt; <a href="../base-4.8.1.0/System-IO.html#t:IO">IO</a> () <a href="src/UtilFunctions.html#createStorageDir" class="link">Source</a></p><div class="doc"><p>Creates path to storage directory, creating missing parents directories on demand.</p></div></div><div class="top"><p class="src"><a name="v:createPath" class="def">createPath</a> :: <a href="../MissingH-1.3.0.1/System-IO-HVFS.html#t:FilePath">FilePath</a> -&gt; <a href="../base-4.8.1.0/System-IO.html#t:IO">IO</a> () <a href="src/UtilFunctions.html#createPath" class="link">Source</a></p><div class="doc"><p>Creates directories in a path to a file, extracting everything prior to the last slash.</p></div></div><div class="top"><p class="src"><a name="v:traverseStore" class="def">traverseStore</a> :: <a href="Types.html#t:TraverseReqs">TraverseReqs</a> -&gt; <a href="../MissingH-1.3.0.1/System-IO-HVFS.html#t:FilePath">FilePath</a> -&gt; <a href="../base-4.8.1.0/System-IO.html#t:IO">IO</a> () <a href="src/UtilFunctions.html#traverseStore" class="link">Source</a></p><div class="doc"><p>Traverse a directory, recursively executing the passed action on each entry.
 Executes the action on each directory entry, too, if anything other that <code><a href="Types.html#v:No">No</a></code> is passed as <code><a href="Types.html#v:aod">aod</a></code> field in <code><a href="Types.html#t:TraverseReqs">TraverseReqs</a></code>.</p></div></div><div class="top"><p class="src"><a name="v:prompt" class="def">prompt</a> :: <a href="../MissingH-1.3.0.1/System-IO-HVFS.html#t:FilePath">FilePath</a> -&gt; <a href="../base-4.8.1.0/System-IO.html#t:IO">IO</a> <a href="../base-4.8.1.0/Data-Bool.html#t:Bool">Bool</a> <a href="src/UtilFunctions.html#prompt" class="link">Source</a></p><div class="doc"><p>Prompt for confirmation in the event of trying to overwriting a target.</p></div></div><div class="top"><p class="src"><a name="v:parseConfirmationRequest" class="def">parseConfirmationRequest</a> :: <a href="../base-4.8.1.0/Data-Bool.html#t:Bool">Bool</a> -&gt; <a href="../base-4.8.1.0/Data-String.html#t:String">String</a> -&gt; <a href="../base-4.8.1.0/Data-Bool.html#t:Bool">Bool</a> <a href="src/UtilFunctions.html#parseConfirmationRequest" class="link">Source</a></p><div class="doc"><p>Parse confirmation request. Takes a default value and a string to be parsed.
 &quot;y&quot;, &quot;yes&quot;, &quot;Y&quot; are recognised as confirmative answers,
 &quot;n&quot;, &quot;no&quot;, &quot;N&quot; as negative, empty line and unrecognised options will be defaulted.</p></div></div><h1 id="g:1">Actions with temporary effects
</h1><div class="top"><p class="src"><a name="v:withEcho" class="def">withEcho</a> :: <a href="../base-4.8.1.0/Data-Bool.html#t:Bool">Bool</a> -&gt; <a href="../base-4.8.1.0/System-IO.html#t:IO">IO</a> a -&gt; <a href="../base-4.8.1.0/System-IO.html#t:IO">IO</a> a <a href="src/UtilFunctions.html#withEcho" class="link">Source</a></p><div class="doc"><p>Set echoing <em>stdin</em>, execute an action and then restore the echo setting to the old value.
 Restores the old value in case of an exception during action's execution.</p></div></div><div class="top"><p class="src"><a name="v:withTempFile" class="def">withTempFile</a> :: (<a href="../MissingH-1.3.0.1/System-IO-HVFS.html#t:FilePath">FilePath</a> -&gt; <a href="../base-4.8.1.0/GHC-IO-Handle.html#t:Handle">Handle</a> -&gt; <a href="../base-4.8.1.0/System-IO.html#t:IO">IO</a> a) -&gt; <a href="../base-4.8.1.0/System-IO.html#t:IO">IO</a> a <a href="src/UtilFunctions.html#withTempFile" class="link">Source</a></p><div class="doc"><p>Execute an action using temporary file.
 Tries writing to <em>/dev/shm</em> in order to avoid writing to difficult-to-erase disk sectors.
 Falls back to default <code>$TMPDIR</code> or <em>/tmp</em> if that variable isn't set and asks for confirmation.</p></div></div><div class="top"><p class="src"><a name="v:withDirectory" class="def">withDirectory</a> :: <a href="../MissingH-1.3.0.1/System-IO-HVFS.html#t:FilePath">FilePath</a> -&gt; <a href="../base-4.8.1.0/System-IO.html#t:IO">IO</a> a -&gt; <a href="../base-4.8.1.0/System-IO.html#t:IO">IO</a> a <a href="src/UtilFunctions.html#withDirectory" class="link">Source</a></p><div class="doc"><p>Change the working directory and restore it afterwards, even if the given action fails due to an exception.</p></div></div><h1 id="g:2">If-functions
</h1><div class="top"><p class="src"><a name="v:-63-" class="def">(?)</a> :: <a href="../base-4.8.1.0/Data-Bool.html#t:Bool">Bool</a> -&gt; a -&gt; a -&gt; a <span class="fixity">infixr 1</span><span class="rightedge"></span> <a href="src/UtilFunctions.html#%3F" class="link">Source</a></p><div class="doc"><p>If-function to avoid using the built-in <code>if-then-else</code> construct.</p></div></div><div class="top"><p class="src"><a name="v:ifOn" class="def">ifOn</a> :: a -&gt; a -&gt; <a href="../base-4.8.1.0/Data-Bool.html#t:Bool">Bool</a> -&gt; a <a href="src/UtilFunctions.html#ifOn" class="link">Source</a></p><div class="doc"><p>If-function with boolean argument passed last. To be used in monad bindings.</p></div></div><div class="top"><p class="src"><a name="v:ifM" class="def">ifM</a> :: <a href="../base-4.8.1.0/Control-Monad.html#t:Monad">Monad</a> m =&gt; m <a href="../base-4.8.1.0/Data-Bool.html#t:Bool">Bool</a> -&gt; m a -&gt; m a -&gt; m a <a href="src/UtilFunctions.html#ifM" class="link">Source</a></p><div class="doc"><p>If-function operating on monadic values.</p></div></div><div class="top"><p class="src"><a name="v:whenM" class="def">whenM</a> :: <a href="../base-4.8.1.0/Control-Monad.html#t:Monad">Monad</a> m =&gt; m <a href="../base-4.8.1.0/Data-Bool.html#t:Bool">Bool</a> -&gt; m () -&gt; m () <a href="src/UtilFunctions.html#whenM" class="link">Source</a></p><div class="doc"><p><code><a href="../base-4.8.1.0/Control-Monad.html#v:when">when</a></code>-function operating on monadic values.</p></div></div><div class="top"><p class="src"><a name="v:-63-.." class="def">(?..)</a> :: <a href="../base-4.8.1.0/Data-Maybe.html#t:Maybe">Maybe</a> a -&gt; b -&gt; (a -&gt; b) -&gt; b <span class="fixity">infixr 1</span><span class="rightedge"></span> <a href="src/UtilFunctions.html#%3F.." class="link">Source</a></p><div class="doc"><p>The same as <code><a href="../base-4.8.1.0/Data-Maybe.html#v:maybe">maybe</a></code>, but with &quot;on Just&quot; option passed last as to increase readability.</p></div></div></div></div><div id="footer"><p>Produced by <a href="http://www.haskell.org/haddock/">Haddock</a> version 2.16.1</p></div></body></html>